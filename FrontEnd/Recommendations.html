<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Sahaara - Your Compass</title>



    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>

    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <script src="https://unpkg.com/framer-motion@latest/dist/framer-motion.js"></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>

   

    <style>

      @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&display=swap");



      html, body {

        width: 100%;

        overflow-x: hidden;

        background-color: #eef1f5;

        font-family: "Nunito", sans-serif;

      }

    </style>

</head>

<body>

    <div id="root"></div>



    <script type="text/babel">

        const { useState, useEffect, useRef } = React;

        const { motion } = Motion;



        // --- Icon Components ---

        const ChatIcon = () => <svg xmlns="http://www.w.3.org/2000/svg" className="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>;

        const BreathingIcon = () => <svg xmlns="http://www.w.org/2000/svg" className="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>;

        const StoryIcon = () => <svg xmlns="http://www.w3.org/2000/svg" className="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>;

        const MusicIcon = () => <svg xmlns="http://www.w3.org/2000/svg" className="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2z" /></svg>;



        // --- UI Components ---

        function Header() {

            return (

                <header className="w-full max-w-5xl mx-auto p-4 flex justify-between items-center">

                    <div className="flex items-center gap-3">

                        <div className="w-10 h-10 bg-[#5a9482] rounded-lg flex items-center justify-center">

                            <span className="text-white text-xl font-bold">Sa</span>

                        </div>

                        <h1 className="font-bold text-xl text-[#333333]">Sahaara</h1>

                    </div>

                </header>

            );

        }



        function CheckInSummary({ mood, energy }) {

            return (

                <div className="bg-white/60 backdrop-blur-md p-3 rounded-xl flex items-center justify-center gap-4 shadow-sm">

                    <span className="font-semibold text-gray-700">Your Check-in:</span>

                    <div className="flex items-center gap-2">

                        <span className="text-2xl">{mood}</span>

                        <div className="w-20 h-2 bg-gray-200 rounded-full overflow-hidden">

                            <div className="h-full bg-gradient-to-r from-[#5a9482] to-[#f9e79f]" style={{ width: `${energy}%` }}></div>

                        </div>

                    </div>

                </div>

            );

        }



        function AnimatedGreeting({ text }) {

            const typeRef = useRef(null);

            useEffect(() => {

                if (!typeRef.current || !text) return;

                const typewriter = new Typewriter(typeRef.current, { delay: 40, cursor: "" });

                typewriter.typeString(text).start();

            }, [text]);

            return <h2 ref={typeRef} className="text-2xl md:text-3xl font-bold text-center text-[#333333] min-h-[64px] md:min-h-[40px]"></h2>;

        }



        function PrimaryCard({ ctaLink }) {

            return (

                <motion.div

                    className="w-full bg-gradient-to-br from-[#5a9482] to-[#4e8070] text-white p-6 md:p-8 rounded-2xl shadow-xl flex flex-col md:flex-row items-center justify-between gap-6"

                    initial={{ opacity: 0, y: 20 }}

                    animate={{ opacity: 1, y: 0 }}

                    transition={{ duration: 0.5, ease: "easeOut" }}

                >

                    <div className="flex items-center gap-6">

                        <div className="hidden md:flex items-center justify-center w-20 h-20 bg-white/20 rounded-full">

                            <BreathingIcon />

                        </div>

                        <div>

                            <h3 className="text-2xl font-bold">Start with a Moment of Calm</h3>

                            <p className="text-white/80 mt-1">This 5-minute breathing exercise can help center your thoughts.</p>

                        </div>

                    </div>

                    <a href={ctaLink} className="w-full md:w-auto flex-shrink-0 px-8 py-3 bg-white text-[#5a9482] font-bold rounded-full text-center transition-transform hover:scale-105">

                        Start Activity

                    </a>

                </motion.div>

            );

        }



        function SecondaryCard({ icon, title, description, buttonText, ctaLink, onClick }) {

            return (

                <motion.div

                    className="w-full bg-white/80 backdrop-blur-md p-6 rounded-2xl shadow-lg flex flex-col h-full"

                    initial={{ opacity: 0, y: 20 }}

                    animate={{ opacity: 1, y: 0 }}

                    transition={{ duration: 0.5, ease: "easeOut" }}

                >

                    <div className="flex items-center gap-4 text-[#5a9482]">

                        {icon}

                        <h3 className="text-xl font-bold text-[#333333]">{title}</h3>

                    </div>

                    <p className="text-gray-600 mt-3 flex-grow">{description}</p>

                    <a href={ctaLink} onClick={onClick} className="w-full block text-center mt-6 py-2.5 bg-[#5a9482] text-white font-bold rounded-full transition-opacity hover:opacity-90">

                        {buttonText}

                    </a>

                </motion.div>

            );

        }



        // --- Main Page Component ---

        function RecommendationsPage() {

            const [recommendations, setRecommendations] = useState(null);

            const [originalAnswers, setOriginalAnswers] = useState(null);



            useEffect(() => {

                const storedRecommendations = localStorage.getItem("sahaaraRecommendations");

                const storedAnswers = localStorage.getItem("sahaaraOriginalAnswers");

                if (storedRecommendations && storedAnswers) {

                    setRecommendations(JSON.parse(storedRecommendations));

                    setOriginalAnswers(JSON.parse(storedAnswers));

                }

            }, []);

           

            const handleMusicClick = () => {

                localStorage.setItem("currentMusicUrl", recommendations.music_url);

            };



            const handleStoryClick = () => {

                localStorage.setItem("currentStoryHeading", recommendations.story_heading);

                localStorage.setItem("currentStoryText", recommendations.story_text);

            };



            if (!recommendations || !originalAnswers) {

                return (

                    <div className="w-full min-h-screen flex items-center justify-center">

                        <p className="text-lg font-semibold text-gray-500">Loading your compass...</p>

                    </div>

                );

            }



            return (

                <div className="w-full min-h-screen">

                    <Header />

                    <main className="w-full max-w-5xl mx-auto p-4 space-y-8">

                        <CheckInSummary mood={originalAnswers.emotion} energy={originalAnswers.energy} />

                        <AnimatedGreeting text={recommendations.recommendations_line} />

                        <PrimaryCard ctaLink="./grounding.html" />



                        <div>

                           <h3 className="text-xl font-bold text-gray-700 mb-4">Explore More Paths</h3>

                           <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

                                <SecondaryCard

                                    icon={<ChatIcon />}

                                    title="Talk it Out"

                                    description={recommendations.chat_welcome}

                                    buttonText="Start Chat"

                                    ctaLink="./chat.html" // <-- UPDATED LINK

                                />

                                <SecondaryCard

                                    icon={<StoryIcon />}

                                    title={recommendations.story_heading}

                                    description="A short, AI-generated story about finding light in the dark."

                                    buttonText="Read Story"

                                    ctaLink="./story.html"

                                    onClick={handleStoryClick}

                                />

                                <SecondaryCard

                                    icon={<MusicIcon />}

                                    title="Find Your Vibe"

                                    description={`Now playing: ${recommendations.music_phrase}`}

                                    buttonText="Listen Now"

                                    ctaLink="./music.html"

                                    onClick={handleMusicClick}

                                />

                           </div>

                        </div>

                    </main>

                </div>

            );

        }



        const root = ReactDOM.createRoot(document.getElementById('root'));

        root.render(<RecommendationsPage />);

    </script>

</body>

</html>
